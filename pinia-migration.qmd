---
title: Pinia Migration Dashboard
format:
  dashboard:
    logo: images/pinia-logo.svg
    nav-buttons:
      - icon: github
        href: https://github.com/mcgaffin/composition-api-migration
        target: _parent
---

```{r setup}
source("R/github_utils.R")
```

```{r pinia-stores}
# Pinia stores (use defineStore)
pinia_results <- request_all_pages("defineStore(", path = "ui/src/store")

pinia_count <- pinia_results$count
pinia_stores <- pinia_results$items |>
  map(\(item) get_names_from_git_response(item, path_prefix = "ui/src/store/"))
```

```{r vuex-stores}
# Vuex stores (use export default {)
vuex_results <- request_all_pages("export%20default%20{", path = "ui/src/store")

vuex_count <- vuex_results$count
vuex_stores <- vuex_results$items |>
  map(\(item) get_names_from_git_response(item, path_prefix = "ui/src/store/"))
```

## Row

```{r}
#| content: valuebox
#| title: "Pinia Migration Progress"
#| icon: speedometer
#| color: primary

glue('{calculate_progress(pinia_count, vuex_count)}%')
```

```{r}
#| content: valuebox
#| title: "Pinia Stores"
#| icon: check-lg
#| color: success

pinia_count
```

```{r}
#| content: valuebox
#| title: "Vuex Stores"
#| icon: hourglass
#| color: warning

vuex_count
```

## Row {.tabset}

```{r}
#| title: "Pinia Stores"

pinia_stores |> render_table(column_name = "Stores")
```

```{r}
#| title: "Vuex Stores"

vuex_stores |> render_table(column_name = "Stores")
```
